{% extends "master.html" %}
{% load static %}

{% block title %}Purchase Price Update{% endblock %}

{% block content %}
<div class="d-flex justify-content-center align-items-center py-5">
  <div class="card shadow-sm border-0" style="width:100%; max-width:500px;">
    <div class="card-body p-4">
      <h4 class="text-center mb-3 fw-bold">Purchase Price Update</h4>
      <p class="text-muted small text-center mb-4">
        Please provide accurate details about your foodstuff sale or purchase. 
        All fields are required.
      </p>

      <form method="post" novalidate>
        {% csrf_token %}
        {{ form.as_p }}

        <button type="submit" class="btn btn-primary w-100 py-2 mt-3">
          Update Price
        </button>
      </form>
    </div>
  </div>
</div>
{% endblock %}

{% block styles %}
<style>
  body {
    background: #f8f9fa; /* subtle grey background */
  }
  .form-control {
    border-radius: 0.5rem;
    padding: 0.7rem 1rem;
  }
  .btn-primary {
    border-radius: 0.5rem;
    font-weight: 500;
    font-size: 1rem;
  }
  .card {
    background-color: #ffffff;
    border-radius: 12px;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
    padding: 3rem 2rem;
    max-width: 600px;
    width: 100%;
  }
</style>
{% endblock %}
{% block scripts %}
<script>
    let stateSelect = document.getElementById("state");
    let lgaSelect = document.getElementById("lga");

    function addPlaceholder(selectElement, text) {
        let opt = document.createElement("option");
        opt.value = "";
        opt.textContent = text;
        opt.disabled = true;
        opt.selected = true;
        selectElement.appendChild(opt);
    }

    addPlaceholder(stateSelect, "Select a State");
    addPlaceholder(lgaSelect, "Select an LGA");

    fetch("{% static 'data/lga.json' %}")
        .then(res => res.json())
        .then(data => {
            Object.keys(data).sort().forEach(state => {
                let opt = document.createElement("option");
                opt.value = state;
                opt.textContent = state;
                stateSelect.appendChild(opt);
            });

            stateSelect.addEventListener("change", function() {
                let lgas = data[this.value] || [];
                lgaSelect.innerHTML = "";
                addPlaceholder(lgaSelect, "Select an LGA");
                lgas.sort().forEach(lga => {
                    let opt = document.createElement("option");
                    opt.value = lga;
                    opt.textContent = lga;
                    lgaSelect.appendChild(opt);
                });
            });
        });
</script>
{% endblock %}
